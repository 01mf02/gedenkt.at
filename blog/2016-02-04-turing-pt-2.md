---
layout: post
title: Running Turing machines in Haskell, pt. 2
---

Some days ago, I was challenged to make a smaller version of my
[Turing machine simulator in Haskell](/blog/2015-01-10-turinghaskell.html),
which I did:

~~~
hdTl [] = (Nothing, [])
hdTl (x:xs) = (Just x, xs)

trans f (s, (l, c, r)) =
  either (\ s' -> let (h, t) = hdTl l in (s', (t, h, c':r)))
         (\ s' -> let (h, t) = hdTl r in (s', (c':l, h, t))) m
  where (c', m) = f c s

run f s = takeWhile ((`notElem` s) . fst) . iterate (trans f)
~~~

This version is a bit more limited, featuring only automatically
generated output for machine runs, but otherwise works similarly.

You can run a machine as follows:

~~~
test c 0 = maybe ('b', Right 1) (\ c -> ('a', Right 0)) c

main = print $ run test [1] (0, ([], Just 'a', "qsdfe"))
~~~
